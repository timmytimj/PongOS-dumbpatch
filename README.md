messy messy messy, loop patched bad var declarations
open issue if ded
